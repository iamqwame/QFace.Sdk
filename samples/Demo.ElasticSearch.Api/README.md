# Demo.ElasticSearch.Api - OpenSearch Demo Application\n\nThis demo application showcases the QFace OpenSearch SDK working with DigitalOcean managed OpenSearch.\n\n## \ud83d\ude80 **What This Demonstrates**\n\n- \u2705 **OpenSearch Connection** - Connects to your DigitalOcean OpenSearch cluster\n- \u2705 **Document Management** - CRUD operations for Products, Categories, Orders\n- \u2705 **Search Functionality** - Full-text search with filtering and facets\n- \u2705 **Repository Pattern** - Clean separation of concerns\n- \u2705 **API Endpoints** - RESTful API with Swagger documentation\n\n## \u26a1 **Quick Start**\n\n### 1. **Build and Run**\n```bash\ndotnet run\n```\n\n### 2. **Open Swagger UI**\nNavigate to: https://localhost:7001/swagger\n\n### 3. **Test OpenSearch Connection**\n```bash\nGET /api/products/health\n```\n\n### 4. **Create Sample Data**\n```bash\nPOST /api/products/sample-data\n```\n\n### 5. **Search Products**\n```bash\nGET /api/products?page=1&pageSize=10\n```\n\n## \ud83d\udcca **API Endpoints**\n\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| `GET` | `/api/products/health` | \ud83d\udfe2 Test OpenSearch connectivity |\n| `POST` | `/api/products/sample-data` | \ud83c\udf31 Create sample products |\n| `GET` | `/api/products` | \ud83d\udcdc Get all products (paginated) |\n| `GET` | `/api/products/{id}` | \ud83d\udd0d Get specific product |\n| `POST` | `/api/products` | \u2795 Create new product |\n| `PUT` | `/api/products/{id}` | \u270f\ufe0f Update existing product |\n| `DELETE` | `/api/products/{id}` | \u2716\ufe0f Delete product (soft delete) |\n| `POST` | `/api/products/search` | \ud83d\udd0e Advanced search with filters |\n\n## \ud83d\udd27 **Configuration**\n\n### **Production (appsettings.json)**\n```json\n{\n  \"Elasticsearch\": {\n    \"NodeUrls\": \"https://db-opensearch-do-user-7791352-0.e.db.ondigitalocean.com:25060\",\n    \"Username\": \"doadmin\",\n    \"Password\": \"AVNS_vzu4qwuXrT819br9zgl\",\n    \"DefaultIndexPrefix\": \"demo\",\n    \"EnableSsl\": true,\n    \"ValidateSslCertificate\": false,\n    \"Sniffing\": { \"Enabled\": false }\n  }\n}\n```\n\n### **Development (appsettings.Development.json)**\n```json\n{\n  \"Elasticsearch\": {\n    \"DefaultIndexPrefix\": \"demo-dev\",\n    \"EnableDebugMode\": true\n  }\n}\n```\n\n## \ud83d\udcdd **Sample Data Structure**\n\n### **Product Document**\n```json\n{\n  \"id\": \"guid\",\n  \"name\": \"MacBook Pro 16\\\"\",\n  \"description\": \"Apple MacBook Pro with M3 chip\",\n  \"price\": 2499.99,\n  \"categoryId\": \"laptops\",\n  \"brand\": \"Apple\",\n  \"tags\": [\"laptop\", \"premium\", \"apple\"],\n  \"stockQuantity\": 25,\n  \"featured\": true,\n  \"rating\": 4.8,\n  \"reviewCount\": 128,\n  \"details\": {\n    \"manufacturer\": \"Apple\",\n    \"model\": \"MacBook Pro 16\\\"\",\n    \"specifications\": {\n      \"processor\": \"Apple M3 Pro\",\n      \"ram\": \"18GB\",\n      \"storage\": \"512GB SSD\"\n    }\n  },\n  \"createdDate\": \"2025-01-01T00:00:00Z\",\n  \"isActive\": true\n}\n```\n\n## \ud83e\uddea **Testing the Demo**\n\n### **1. Health Check**\n```bash\ncurl https://localhost:7001/api/products/health\n\n# Expected Response:\n{\n  \"status\": \"Healthy\",\n  \"openSearchConnected\": true,\n  \"totalProducts\": 0,\n  \"timestamp\": \"2025-08-03T...\"\n}\n```\n\n### **2. Create Sample Data**\n```bash\ncurl -X POST https://localhost:7001/api/products/sample-data\n\n# Expected Response:\n{\n  \"message\": \"Created 3 sample products\",\n  \"count\": 3,\n  \"products\": [\n    { \"id\": \"...\", \"name\": \"MacBook Pro 16\\\"\", \"price\": 2499.99 },\n    { \"id\": \"...\", \"name\": \"Dell XPS 13\", \"price\": 1299.99 },\n    { \"id\": \"...\", \"name\": \"iPhone 15 Pro\", \"price\": 999.99 }\n  ]\n}\n```\n\n### **3. Search Products**\n```bash\ncurl -X POST https://localhost:7001/api/products/search \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"searchText\": \"MacBook\",\n    \"page\": 1,\n    \"pageSize\": 10\n  }'\n\n# Expected Response:\n{\n  \"products\": [...],\n  \"totalCount\": 1,\n  \"page\": 1,\n  \"pageSize\": 10,\n  \"totalPages\": 1\n}\n```\n\n### **4. Advanced Search with Filters**\n```bash\ncurl -X POST https://localhost:7001/api/products/search \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"brand\": \"Apple\",\n    \"minPrice\": 500,\n    \"maxPrice\": 3000,\n    \"onlyFeatured\": true,\n    \"sortBy\": \"PriceLowToHigh\",\n    \"page\": 1,\n    \"pageSize\": 20\n  }'\n```\n\n## \ud83d\udd0d **Troubleshooting**\n\n### **Connection Issues**\n1. Check the health endpoint: `/api/products/health`\n2. Enable debug mode: Set `EnableDebugMode: true` in appsettings\n3. Check logs for OpenSearch connection errors\n4. Verify DigitalOcean OpenSearch credentials\n\n### **Search Issues**\n1. Create sample data first: `POST /api/products/sample-data`\n2. Wait a few seconds for indexing to complete\n3. Try simple search: `GET /api/products`\n4. Check if indices exist in OpenSearch dashboard\n\n### **Index Issues**\n```bash\n# Check what indices exist\ncurl -u \"doadmin:AVNS_vzu4qwuXrT819br9zgl\" \\\n  \"https://db-opensearch-do-user-7791352-0.e.db.ondigitalocean.com:25060/_cat/indices?v\"\n```\n\n## \ud83c\udf86 **Success Indicators**\n\n\u2705 **Application starts without errors**  \n\u2705 **Health endpoint returns \"Healthy\"**  \n\u2705 **Sample data creation succeeds**  \n\u2705 **Search returns results**  \n\u2705 **Swagger UI is accessible**  \n\n## \ud83d\udcda **What's Demonstrated**\n\n- **OpenSearch Integration**: Direct connection to DigitalOcean OpenSearch\n- **Document Mapping**: Proper attribute mapping for OpenSearch\n- **Repository Pattern**: Clean data access layer\n- **Search Capabilities**: Full-text search with filtering\n- **Error Handling**: Comprehensive exception handling\n- **Logging**: Structured logging with Serilog\n- **API Design**: RESTful endpoints with proper HTTP status codes\n\n---\n\n**Demo.ElasticSearch.Api** - Showcasing QFace OpenSearch SDK v2.0 with DigitalOcean! \ud83d\ude80\n